local soundFont = {
   "block.note_block.harp",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.snare",
   "entity.experience_orb.pickup",
   "entity.experience_orb.pickup",
   "entity.experience_orb.pickup",
   "entity.experience_orb.pickup",
   "block.note_block.pling",
   "block.anvil.placepling",
   "block.note_block.pling",
   "entity.experience_orb.pickup",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "minecraft:block.note_block.guitar",
   "minecraft:block.note_block.guitar",
   "minecraft:block.note_block.guitar",
   "block.note_block.snare",
   "minecraft:block.note_block.guitar",
   "minecraft:block.note_block.guitar",
   "minecraft:block.note_block.guitar",
   "block.note_block.bass",
   "minecraft:block.note_block.guitar",
   "block.note_block.pling",
   "block.note_block.bass",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.bass",
   "block.note_block.bass",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.lava.pop",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.harp",
   "entity.zombie.infect",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.flute",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.bass",
   "block.note_block.bass",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "entity.zombie.infect",
   "entity.zombie.infect",
   "entity.zombie.infect",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.harp",
   "block.note_block.harp",
   "block.note_block.bit",
   "block.note_block.pling",
   "block.note_block.pling",
   "entity.zombie.infect",
   "entity.zombie.infect",
   "block.note_block.pling",
   "entity.experience_orb.pickup",
   "entity.zombie.infect",
   "block.note_block.pling",
   "block.note_block.pling",
   "orbplingentity.zombie.infect",
   "ingore",
   "block.note_block.harp",
   "block.note_block.pling",
   "block.anvil.place",
   "block.note_block.bass",
   "block.note_block.pling",
   "block.note_block.harp",
   "block.note_block.flute",
   "block.note_block.pling",
   "block.note_block.bass",
   "block.note_block.bass",
   "block.note_block.bass",
   "block.note_block.bass",
   "block.note_block.hat",
   "block.note_block.pling",
   "block.note_block.pling",
   "block.note_block.pling",
   "entity.experience_orb.pickup",
   "entity.item.pickup",
   "block.note_block.pling",
   "block.note_block.hat",
   "block.note_block.snare",
   "entity.item.pickup",
   "block.note_block.snare",
   "ingore",
   "block.stone.place",
   "block.note_block.bass",
   "ingore",
   "entity.zombie.infect",
   "entity.zombie.infect",
   "ingore",
   "ingore",
   "entity.lightning_bolt.impact"
}

local percussionFont = { -- starts at 35
nil,nil,nil,nil,nil,
nil,nil,nil,nil,nil,
nil,nil,nil,nil,nil,
nil,nil,nil,nil,nil,
nil,nil,nil,nil,nil,
nil,nil,nil,nil,nil,
nil,nil,nil,nil,nil,
   "block.note_block.basedrum",
   "block.note_block.basedrum",
   "block.note_block.basedrum",
   "block.stone.break",
   "block.note_block.snare",
   "block.copper.place",
   "block.note_block.snare",
   "block.copper.place",
   "block.note_block.snare",
   "block.note_block.bass",
   "block.note_block.snare",
   "block.note_block.bass",
   "block.note_block.bass",
   "block.note_block.bass",
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   nil,
   "block.wood.break",
}

function pings.midi(note,isntrument,velocity,perc)
   if player:isLoaded() then
      local pos = player:getPos():add(0,2.4,0)
      local pitch = 1
      if soundFont[(isntrument or 0) + 1] == "minecraft:block.note_block.guitar" then
         pitch = 2
      end
      pos:add(vectors.rotateAroundAxis(90,client:getCameraDir():mul(1,0,1):normalize()* (note % 24 / 12 - 1),vectors.vec3(0,1,0)))
      local vol = math.clamp(math.map((pos-client:getCameraPos()):length(),0,16,1,0),0,1) * velocity
      particles:newParticle("minecraft:note",pos,vectors.vec3(note/24,0,0))
      --particles:newParticle("minecraft:end_rod",pos):scale(1):lifetime(20):gravity(0):velocity(0,-0.2,0):color(vectors.hsvToRGB(note/-24+0.24,1,1))
      if perc then
         if percussionFont[note] then
            sounds[percussionFont[note]]:pos(client:getCameraPos() + client:getCameraDir()):volume(vol):play()
         end
      else
         pitch = pitch * 2 ^ (((note) - (12 * 6 - 3)) / 12)
         sounds[soundFont[(isntrument or 0) + 1]]:pitch(pitch):pos(client:getCameraPos() + client:getCameraDir()):volume(vol):play()
      end
   end
end