local swordLib = require("libraries.sword")
local tweenLib = require("libraries.GNTweenLib")
local trailLib = require("libraries.GNtrailLib")
trailLib:setWorld(models:newPart("TrailWorldEZ"))

local sword = swordLib.new()
local trail = trailLib:newTwoLeadTrail():setDuration(5)


events.ENTITY_INIT:register(function ()
   sword:setPos(player:getPos())
   sword:setVel(0.1,0,0)
   sword.spinvel = -45
end)

events.WORLD_RENDER:register(function (delta)
   local mat = sword.part:partToWorldMatrix()
   trail:setLeads(mat:apply(0,0,0),mat:apply(0,20,0),1)
end)


keybinds:newKeybind("yeet","key.keyboard.h").press = function ()
   local block,hit = player:getTargetedBlock()
   local pos = player:getPos()
   tweenLib.tweenFunction(pos,hit,1,"linear",function (x,t)
      sword.pos = x:add(0,math.sin(t*math.pi)*2,0)
   end,function ()
      tweenLib.tweenFunction(hit,pos,1,"linear",function (x,t)
         sword.pos = x:add(0,math.sin(t*-math.pi)*2,0)
      end)
   end)
end